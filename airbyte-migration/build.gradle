import com.bmuschko.gradle.docker.tasks.image.DockerBuildImage

plugins {
    id 'application'
    id 'com.bmuschko.docker-remote-api'
}

dependencies {
    implementation project(':airbyte-json-validation')

    implementation 'net.sourceforge.argparse4j:argparse4j:0.8.1'

    testImplementation project(':airbyte-config:models')
    testImplementation project(':airbyte-db:lib')
}

application {
    mainClass = 'io.airbyte.migrate.MigrationRunner'
}

// Use task types
task buildMyAppImage(type: DockerBuildImage) {
    dependsOn compileTestJava
    dependsOn distTar
    dependsOn distZip
    dependsOn jar
    dependsOn processTestResources
    dependsOn startScripts
    inputDir = file('.')
    images.add("airbyte/migration:$version")
}
build.dependsOn(buildMyAppImage)
